participant User
participant BadClient

User->AuthServer: GET /authorize?client_id=good&redirect_uri=/bad/peek&state=poioiu

note right of AuthServer
  AuthServer checks 
  validity of state
end note

activate User
activate AuthServer

AuthServer->User: 302: location=/bad/peek?code=dkshfjg&state=poioiu
deactivate User
deactivate AuthServer

User->BadClient: GET /peek?code=dkshfjg&state=poioiu
activate User
activate BadClient

BadClient->AuthServer: POST: /token?code=dkshfjg&state=poioiu

activate AuthServer

note right of BadClient
 Assume BadClient knows 
 client secret
end note

AuthServer->BadClient: 200: {access_token:CNMBVCXKVY} 

deactivate AuthServer
deactivate BadClient
deactivate User
